---
author: ths
comments: true
date: 2011-08-22 06:08:00+00:00
layout: post
slug: '%e7%bb%9f%e8%ae%a1%e6%89%80%e6%9c%89%e8%a1%a8%e8%a1%8c%e6%95%b0%e7%9a%84sql%e8%af%ad%e5%8f%a5'
title: 统计所有表行数的sql语句
wordpress_id: 664
categories:
- 技术
tags:
- sql
- 表行数
---

<





p>SELECT o.name AS "Table Name", i.rowcnt AS "Row Count"  
![](http://www.cnblogs.com/Images/OutliningIndicators/None.gif)FROM sysobjects o, sysindexes i  
![](http://www.cnblogs.com/Images/OutliningIndicators/None.gif)WHERE i.id = o.id  
![](http://www.cnblogs.com/Images/OutliningIndicators/None.gif)AND i.indid IN(0,1)  
![](http://www.cnblogs.com/Images/OutliningIndicators/None.gif)AND o.xtype = 'u' --只统计用户表  
![](http://www.cnblogs.com/Images/OutliningIndicators/None.gif)AND o.name <> 'sysdiagrams'  
![](http://www.cnblogs.com/Images/OutliningIndicators/None.gif)ORDER BY i.rowcnt DESC --按行排降序  
![](http://www.cnblogs.com/Images/OutliningIndicators/None.gif)  
![](http://www.cnblogs.com/Images/OutliningIndicators/None.gif)COMPUTE SUM(i.rowcnt), count(o.name); --汇总行数，表数  
![](http://www.cnblogs.com/Images/OutliningIndicators/None.gif)GO



