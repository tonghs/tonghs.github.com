---
author: ths
comments: true
date: 2010-11-30 05:21:11+00:00
layout: post
slug: '%e9%a1%b5%e9%9d%a2%e6%89%93%e5%8d%b0'
title: 页面打印
wordpress_id: 130
categories:
- 技术
---






    


        
  1. script language="Javascript">

        
  2. function preview()

        
  3. {

        
  4. bdhtml=window.document.body.innerHTML;

        
  5. sprnstr="<!--startprint-->";

        
  6. eprnstr="<!--endprint-->";

        
  7. prnhtml=bdhtml.substr(bdhtml.indexOf(sprnstr)+17);

        
  8. prnhtml=prnhtml.substring(0,prnhtml.indexOf(eprnstr));

        
  9. window.document.body.innerHTML=prnhtml;

        
  10. window.print();

        
  11. window.location.reload();

        
  12. }

        
  13. </script>

    







    


        

[view plain](http://blog.csdn.net/tonghuashuai2009/archive/2010/08/19/5823475.aspx#)[copy to clipboard](http://blog.csdn.net/tonghuashuai2009/archive/2010/08/19/5823475.aspx#)[print](http://blog.csdn.net/tonghuashuai2009/archive/2010/08/19/5823475.aspx#)[?](http://blog.csdn.net/tonghuashuai2009/archive/2010/08/19/5823475.aspx#)


    


    


        
  1. <!--省略部分代码-->

        
  2. <form id="WebForm1" method="post" runat="server">

        
  3. <center>本部分以上不被打印</center>

        
  4. <!--startprint-->

        
  5. <div align="center">

        
  6. <asp:DataGrid id="dgShow" runat="server">

        
  7. <!--省略部分代码-->

        
  8. </asp:DataGrid>

        
  9. </div>

        
  10. <!--endprint-->

        
  11. <center>本部分以下不被打印</center>

        
  12. <div align="center">

        
  13. <input type="button" name="print" value="预览并打印" onclick="preview()">

        
  14. </div>

        
  15. <mce:style><!--

        
  16. @media Print { .Noprn { DISPLAY: none }}

        
  17. 
        
  18. --></mce:style><style mce_bogus="1"> @media Print { .Noprn { DISPLAY: none }}

        
  19. </style>

        
  20. <p class="Noprn">不打印</p>

        
  21. <table id="datagrid">

        
  22. <tr>

        
  23. <td>打印</td>

        
  24. </tr>

        
  25. </table>

        
  26. <input class="Noprn" type="button" onclick="window.print()" value="print">

        
  27. </form>

    




