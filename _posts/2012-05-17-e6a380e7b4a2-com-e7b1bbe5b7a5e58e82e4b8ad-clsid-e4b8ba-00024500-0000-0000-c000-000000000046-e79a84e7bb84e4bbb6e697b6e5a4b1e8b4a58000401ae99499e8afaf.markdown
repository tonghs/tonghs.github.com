---
author: ths
comments: true
date: 2012-05-17 09:16:00+00:00
layout: post
slug: '%e6%a3%80%e7%b4%a2-com-%e7%b1%bb%e5%b7%a5%e5%8e%82%e4%b8%ad-clsid-%e4%b8%ba-00024500-0000-0000-c000-000000000046-%e7%9a%84%e7%bb%84%e4%bb%b6%e6%97%b6%e5%a4%b1%e8%b4%a58000401a%e9%94%99%e8%af%af'
title: 检索 COM 类工厂中 CLSID 为 {00024500-0000-0000-C000-000000000046} 的组件时失败,8000401a错误解决方案
wordpress_id: 753
categories:
- 技术
tags:
- c
- excel导出
---

在编写生成Excel 程序在win 20003 运行里，遇到了“检索 COM 类工厂中 CLSID 为 {000209FF-0000-0000-C000-000000000046} 的组件时失败，原因是出现以下错误: 8000401a。 的错误.”问题，在网上主要解决办法为两种： 





1、[http://support.microsoft.com/kb/288366](http://support.microsoft.com/kb/288366)





2、 解决方法如下: 





1:在服务器上安装office的Excel软件. 





2:在"开始"->"运行"中输入dcomcnfg.exe启动"组件服务" 





3:依次双击"组件服务"->"计算机"->"我的电脑"->"DCOM配置" 





4:在"DCOM配置"中找到"Microsoft Excel 应用程序",在它上面点击右键,然后点击"属性",弹出"Microsoft Excel 应 





用程序属性"对话框 





5:点击"标识"标签,选择"交互式用户" 





6:点击"安全"标签,在"启动和激活权限"上点击"自定义",然后点击对应的"编辑"按钮,在弹出的"安全性"对话框中填加 





一个"NETWORK SERVICE"用户(注意要选择本计算机名),并给它赋予"本地启动"和"本地激活"权限. 





7:依然是"安全"标签,在"访问权限"上点击"自定义",然后点击"编辑",在弹出的"安全性"对话框中也填加一个"NETWORK 





SERVICE"用户,然后赋予"本地访问"权限. 





这样,我们便配置好了相应的Excel的DCOM权限. 





注意:这是在WIN2003上配置的,在2000,xp上,是配置ASPNET用户 





由于EXCEL是在服务器上打开的，所以应该写一个把导出数据保存在服务器上,然后再传递给客户端的方法,最后每次调 





用这个功能的时候再删除以前在服务器上所生成的所有Excel 





---------- 





我的结果以上两种方法，都不行。 





参考多数资料： 





简单的记录下自己我解决方法： 





1、创建一个用户账号，设置所属于Power User或者User; 





2、运行DCOMCNFG，在Dcom组件里面找到Microsoft Excel 应用程序或者Microsoft excel文档-属性-标识里面选择“特定用户”，然后输入前面建立的帐号和密码就可以了； 





3、在web.config配置文件里添加一个支点〈identity /〉即可； 









另附: 





在网上找了很多很多方法。但是就不能解决问题，愁死我了。所有配置都弄的好好的，就不行。。





最后在这篇文章里找到了解决的方法，在我标记*****的地方。哈哈





.NET导出Excel遇到的80070005错误的解决方法:  
检索 COM 类工厂中 CLSID 为 {00024500-0000-0000-C000-000000000046}的组件时失败，原因是出现以下错误: 80070005基本上.net导出excel文件，都需要如此配置一下，不配置有的时候没错，而配置后基本应该不会出错。  
具体配置方法如下:   
1:在服务器上安装office的Excel软件.  
2:在"开始"->"运行"中输入dcomcnfg.exe启动"组件服务"   
3:依次双击"组件服务"->"计算机"->"我的电脑"->"DCOM配置"  
4:在"DCOM配置"中找到"Microsoft Excel 应用程序",在它上面点击右键,然后点击"属性",弹出"Microsoft Excel 应用程序属性"对话框   
5:点击"标识"标签,选择"交互式用户"   
6:点击"安全"标签,在"启动和激活权限"上点击"自定义",然后点击对应的"编辑"按钮,在弹出的"安全性"对话框中填加一个"NETWORK SERVICE"用户(注意要选择本计算机名),并给它赋予"本地启动"和"本地激活"权限.   
7:依然是"安全"标签,在"访问权限"上点击"自定义",然后点击"编辑",在弹出的"安全性"对话框中也填加一个"NETWORK SERVICE"用户,然后赋予"本地访问"权限.   
8.如果交互式用户设置后出现错误8000401a，可取消交互式用户，指定为administratr，可暂时解决此问题。进一步的解决方式还有待探讨。   
9.采用第8点的设置后，打开Excel可能会出现“无法使用对象引用或链接”，并且不能进行单元格粘贴。原因不明，取消设置后即可消失。 





******另外说明：光按以上设置并不能完全保证不出问题，因为调用OFFICE的操作可能涉及其他的系统资源，很可能依然权限不够而导致问题，只是设置EXCEL应用程序后，还是可能会报80070005的错误，最保险的是应该在dcomcnfg中选中我的电脑然后右键属性－＞com安全，将里面的访问权限，启动和激活权限全都编辑默认，在当中加上network service(iis 5.0的话，要加的是asp.net用户)，并如前面对networkservice设置上相同的权限，这样基本上能保证不会再出什么问题。******





以上为基本出路方法，但是我也遇到过应用以上方法还是报错的情况，我的环境是windows2003 + office2003+office2007，在测试服务器上都可以导出无任何问题！但是更新了正式环境就是报错，权限都设置了还是报错，因为我的测试服务器是默认office启动的，所以我怀疑是office版本环境问题！于是我卸载了office2007，马上测试ok了，但是重启服务器后就产生了have not been Pre-compiled错误，导出页面都无法打开了，于是我又重新安装了office2007，页面可以打开了，但是导出excel时又开始报错！我又把所有的权限重新设置一遍，问题依旧！后来发现两个服务器默认打开excel的程序不一样，测试环境是默认office2003打开，正式环境是office2007打开，于是我在正式环境重新注册office2003，使其同样也是默认office2003打开程序，靠！问题终于解决了！！！





注册方法执行 开始----运行----输入excel2003的安装路径，例如 "C:Program FilesMicrosoft OfficeOFFICE11excel.exe" /regserver 注意/符号前面有一个空格，其中"C:Program FilesMicrosoft OfficeOFFICE11excel.exe" 是excel2003的安装程序的路径，参数regserver表示注册的意思！  
运行后，会启动Office 2003的安装程序，进行修复，重新注册。  
excel2007为默认的启动程序的方法类同，可以执行 开始----运行----"D:Program FilesMicrosoft OfficeOffice12excel.exe" /regserver  
综上所述，再遇到Excel导出、导入问题时，先考虑权限问题，再考虑office的版本环境！如此基本能够解决这些问题了。



