---
author: ths
comments: true
date: 2013-12-13 08:18:28+00:00
layout: post
slug: '%e8%bf%9e%e6%8e%a5-vpn-%e4%b8%8d%e8%83%bd%e8%ae%bf%e9%97%ae%e5%86%85%e7%bd%91'
title: 连接 VPN 不能访问内网
wordpress_id: 1697
categories:
- 未分类
tags:
- VPN
- 内网
---

在测试 `VPN` 时发现一个问题，只要连上就无法连接到内网（192.168.100.xxx），Google 之，得如下方法：







  1. 建两个文件 start.bat 和 end.bat


  2. start.bat 中写以下语句





@echo off
for /F "tokens=3" %%* in ('route print ^| findstr "\<0.0.0.0>"') do set "gw=%%*"





ipconfig /flushdns
route add 192.168.100.0 mask 255.255.255.0 %gw% metric 25



  3. end.bat 中写一下语句





@echo off
route delete 192.168.100.0



  4. 连 `vpn` 时执行 start.bat，断开 `vpn` 后执行 end.bat 即可。






一般 `vpn` 客户端都有区分国内网络的功能，如`二师兄`客户端下的 route.dat，只需在文件最后添加以下语句同样也能解决：




    
    <code>192.168.100.0=255.255.255.0
    </code>



