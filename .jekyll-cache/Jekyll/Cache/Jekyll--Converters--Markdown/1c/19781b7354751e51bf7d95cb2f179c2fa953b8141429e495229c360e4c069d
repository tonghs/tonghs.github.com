I"Š<p>æœ€è¿‘åœ¨å­¦ä¹  Redisï¼Œå­¦çš„æ—¶å€™å°è¯•å†™ä¸€ä¸ªåšå®¢ç¨‹åºï¼Œç¬¬ä¸€æ¬¡ç”¨ NoSQLï¼Œç”¨èµ·æ¥è¿˜æ˜¯æœ‰ä¸€äº›é—®é¢˜çš„ï¼Œå…¶ä¸­ä¸»è¦çš„å°±æ˜¯ï¼šä» RDB åˆ° NoSQL æ€æƒ³çš„è½¬å˜ï¼Œå¤„ç†é—®é¢˜çš„æ€æƒ³ä¸ä¸€æ ·ã€‚</p>

<p>æ¥ä¸‹æ¥è¯´ä¸€ä¸ªæˆ‘é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸åŒå¯¹è±¡ä¹‹é—´çš„å…³è”é—®é¢˜ï¼Œå°±æ‹¿<code class="highlighter-rouge">æ–‡ç« </code>å’Œ<code class="highlighter-rouge">ä¾¿ç­¾</code>æ¥ä¸¾ä¾‹ã€‚</p>

<p>åœ¨å…³ç³»å‹æ•°æ®åº“(ä»¥MySQLä¸ºä¾‹)ä¸­ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸‹æ–¹æ³•å¤„ç†ï¼Œç›´æ¥çœ‹ SQLï¼š</p>

<p>æ–‡ç« è¡¨ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>create table tb_post(
    post_id bigint not null primary key auto_increment,
    post_title varchar(100) not null default '',
    post_content text
)
</code></pre></div></div>

<p>æ ‡ç­¾è¡¨ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>create table tb_tag(
    tag_id bigint not null primary key auto_increment,
    tag_name varchar(20)
)
</code></pre></div></div>

<p>æ–‡ç« å’Œæ ‡ç­¾æ˜¯å¤šå¯¹å¤šå…³ç³»ï¼Œæ‰€ä»¥å†å»ºç«‹ä¸€ä¸ªå…³è”è¡¨ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>create table tb_post_tag(
    post_tag_id bigint not null primary key auto_increment,
    post_id bigint not null,
    tag_id bigint not null
)
</code></pre></div></div>

<p>ä¸‹é¢å°±æ˜¯ Redis çš„å®ç°æ–¹æ³•ï¼š</p>

<p>åœ¨ç”¨ä¹‹å‰ï¼Œæˆ‘æŸ¥äº†ä¸€ä¸‹ç½‘ä¸Šå¤§å®¶çš„åšæ³•ï¼Œåœ¨ Redis ç½‘ç«™ä¸Šä¸€ç¯‡æ–‡ç« å« <a href="http://redis.io/topics/data-types-intro">ã€ŠA fifteen minute introduction to Redis data typesã€‹</a>ï¼Œé‡Œé¢ä»‹ç»äº† Redis çš„é›†ä¸­æ•°æ®ç±»å‹ï¼Œå…¶ä¸­ä»‹ç»é›†åˆ(Sets)ç±»å‹çš„æ®µè½ä¸­æœ‰è¿™ä¹ˆä¸€å¥è¯ï¼š</p>

<blockquote>
  <p>Sets are very good for expressing relations between objects. For instance we can easily use Redis Sets in order to implement tags.</p>
</blockquote>

<p>è¯´çš„å¾ˆæ¸…æ¥šäº†ï¼Œè¿™ç§å…³è”å…³ç³»å¯ä»¥ç”¨é›†åˆ(Sets)æ¥å®ç°ï¼Œè€Œä¸”ç»™å‡ºçš„ä¾‹å­ä¹Ÿæ˜¯æ–‡ç« å’Œæ ‡ç­¾çš„ï¼Œæˆ‘å°±ä¸çŒ®ä¸‘äº†ï¼Œç›´æ¥ä¸ŠåŸæ–‡ä¸­çš„ä¾‹å­ï¼š</p>

<blockquote>
  <p>A simple way to model this is to have a Set for every object containing its associated tag IDs, and a Set for every tag containing the object IDs that have that tag. For instance if our news ID 1000 is tagged with tag 1,2,5 and 77, we can specify the following five Sets - one Set for the objectâ€™s tags, and four Sets for the four tags:</p>

  <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ redis-cli sadd news:1000:tags 1
(integer) 1
$ redis-cli sadd news:1000:tags 2
(integer) 1
$ redis-cli sadd news:1000:tags 5
(integer) 1
$ redis-cli sadd news:1000:tags 77
(integer) 1
$ redis-cli sadd tag:1:objects 1000
(integer) 1
$ redis-cli sadd tag:2:objects 1000
(integer) 1
$ redis-cli sadd tag:5:objects 1000
(integer) 1
$ redis-cli sadd tag:77:objects 1000
(integer) 1
</code></pre></div>  </div>

  <p>To get all the tags for a given object is trivial:</p>

  <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ redis-cli smembers news:1000:tags
1. 5
2. 1
3. 77
4. 2
</code></pre></div>  </div>

</blockquote>

<p>ä¸Šé¢çš„æ–°é—»(news)ï¼Œå°±æƒ³å½“ä¸æˆ‘ä»¬ä¸Šæ–‡ä¸­çš„ postï¼Œè¿™ä¹ˆå®ç°å°±å¾ˆæ¸…æ¥šäº†ã€‚</p>

<p>æœ€åæ¨èä¸‹è¿™ç¯‡æ–‡ç« ï¼š <a href="http://redis.io/topics/data-types-intro">ã€ŠA fifteen minute introduction to Redis data typesã€‹</a>ï¼Œéå¸¸å€¼å¾—ä¸€è¯»ã€‚</p>

:ET