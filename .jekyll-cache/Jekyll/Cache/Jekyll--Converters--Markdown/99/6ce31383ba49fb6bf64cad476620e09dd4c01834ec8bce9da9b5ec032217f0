I"7
<p>wraps 的作用有很多，主要是修改函数的签名，其作用之一是改变函数的 __name__，__doc__。如果你的装饰器不用 wraps，那么被装饰的不同的函数的名字都变成了相同的名字。在 flask 中注册这两个视图时就会发生冲突，提示：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AssertionError: View function mapping is overwriting an existing endpoint function
</code></pre></div></div>

<p>一个例子：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">login_required</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
 
    <span class="o">@</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>  <span class="c1"># 这个装饰器必须有
</span>    <span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">courier_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'X-ID'</span><span class="p">)</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'X-TOKEN'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verify_login_token</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">courier_id</span><span class="p">),</span> <span class="n">token</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span><span class="p">(</span><span class="n">ResponseCode</span><span class="o">.</span><span class="n">UNAUTHORIZED</span><span class="p">)</span>
 
    <span class="k">return</span> <span class="n">wrap</span>
</code></pre></div></div>
:ET