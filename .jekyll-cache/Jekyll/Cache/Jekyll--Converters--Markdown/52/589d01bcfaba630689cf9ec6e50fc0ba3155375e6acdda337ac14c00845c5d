I"¥<p>çº ç»“äºæ¯æ¬¡githubæäº¤ä»£ç åéƒ½è¦å»vpsä¸­git pullä¸€ä¸‹ï¼Œæ—©å°±æŠŠæŒç»­é›†æˆæä¸Šäº†æ—¥ç¨‹ï¼Œæ— å¥ˆå‰ç«¯æ—¶é—´å·¥ä½œå¤ªå¿™ï¼Œæ— æš‡é¡¾åŠï¼Œç®€å•æŠ˜è…¾äº†ä¸€ä¸‹æ²¡æœ‰æˆåŠŸï¼Œäºæ˜¯è¿™ä¸ªä»»åŠ¡åœ¨æˆ‘çš„ä»»åŠ¡åˆ—è¡¨äº†èººäº†å¥½ä¹…ã€‚</p>

<p>æœ€ç»å·¥ä½œä¸ç®—å¿™ï¼Œå°±æŠ½äº†ä¸€ä¸Šåˆå¼„äº†ä¸€ä¸‹ï¼Œæ€»ç®—æˆåŠŸï¼Œç‰¹æ­¤è®°å½•ã€‚ä¹Ÿå¯¹ç½‘ä¸Šå„ç§ä¸åŠ éªŒè¯çš„æ–¹æ¡ˆæŠ„è¢­è¡¨ç¤ºé„™è§†ï¼ï¼ï¼</p>

<p>å…ˆè¯´ç¯å¢ƒï¼šUbuntu(12.10) + Python + Django/web.py + nginx + uwsgiï¼Œå·¥å…·ç”¨çš„Jenkins(1.538)ã€‚</p>

<p>å®ç°åˆ°ä»€ä¹ˆç¨‹åº¦ï¼šä»£ç æäº¤åˆ°githubåï¼Œvpsç«¯è‡ªåŠ¨pullï¼Œå¹¶ä¸”é‡å¯uwsgiï¼Œreload nginxã€‚å…¶å®è¯´æŒç»­é›†æˆæ–¹æ¡ˆæœ‰ç‚¹å„¿å¤§äº†ï¼Œå®é™…æˆ‘åªç”¨åˆ°äº†è‡ªåŠ¨éƒ¨ç½²ï¼Œå…¶ä»–çš„è‡ªåŠ¨æµ‹è¯•ï¼Œé›†æˆsonar reviewç­‰åç»­å†åŠ ã€‚</p>

<p>ä¸‹é¢è¯´æ­¥éª¤ï¼š</p>

<p>ä¸€ã€<strong>å®‰è£…</strong></p>

<p><a href="http://pkg.jenkins-ci.org/debian/">http://pkg.jenkins-ci.org/debian/</a>ï¼Œè¯¥åœ°å€ä¸‹æœ‰å®‰è£…æ–¹æ³•å’ŒdebåŒ…ä¸‹è½½ã€‚æˆ–çœ‹ä¸€ä¸‹æ­¥éª¤ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget -q -O - http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key | sudo apt-key add -
</code></pre></div></div>

<p>ç„¶å</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo vim  /etc/apt/sources.list
</code></pre></div></div>

<p>åŠ å…¥ä»¥ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>deb http://pkg.jenkins-ci.org/debian binary/
</code></pre></div></div>

<p>ç„¶å</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt-get update
sudo apt-get install jenkins
</code></pre></div></div>

<p>å®‰è£…æˆåŠŸåå¯åŠ¨ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo service jenkins
</code></pre></div></div>

<p>åœ¨æ­¤æˆ‘å‡ºäº†ç‚¹é—®é¢˜ï¼Œç”¨è¯¥å‘½ä»¤å¯åŠ¨åæç¤ºï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Job filed to start
</code></pre></div></div>

<p>åŸå› ä¸è¯¦ï¼Œä½†æ˜¯ç”¨ä¸€ä¸‹è¯­å¥å°±èƒ½å¯åŠ¨ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo /etc/init.d/jenkins start
</code></pre></div></div>

<p>å¯åŠ¨åç›´æ¥è®¿é—®http://173.208.199.58:8080/(æˆ‘çš„vps ip æ˜¯ 173.208.199.58ï¼‰</p>

<p>å¦‚æœèƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œè‡³æ­¤å®‰è£…å®Œæˆã€‚</p>

<p>å®‰è£…åworkspaceè·¯å¾„ä¼šå»ºåœ¨ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/var/lib/jenkins/
</code></pre></div></div>

<p>logç›®å½•ä¸ºï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/var/log/jenkins/
</code></pre></div></div>

<p>é…ç½®æ–‡ä»¶ä¸ºï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/etc/default/jenkins
</code></pre></div></div>

<p>äºŒã€<strong>é…ç½®</strong></p>

<ul>
  <li>è£…æ’ä»¶ï¼Œç”±äºä»£ç æ‰˜ç®¡åœ¨githubï¼Œæ‰€æœ‰è¦è£…git plugin å’Œ github plugin</li>
</ul>

<p>ä¾æ¬¡ç‚¹å‡»ï¼šManage Jenkinsâ€“Manage Pluginsâ€“Availableæ ‡ç­¾ï¼ŒæŸ¥æ‰¾ä¸Šè¿°ä¸¤ä¸ªæ’ä»¶å®‰è£…ã€‚ï¼ˆå¦‚æœè¯¥æ ‡ç­¾ä¸ºç©ºï¼Œåˆ™ç‚¹å‡»Advancedæ ‡ç­¾ï¼Œç„¶åå³ä¸‹è§’ç‚¹å‡»â€Check nowâ€ æŒ‰é’®ï¼Œå®Œæˆåå°±æœ‰äº†ï¼‰</p>

<ul>
  <li>
    <p>é…ç½®ï¼Œæ’ä»¶å®‰è£…å®Œæˆåï¼Œä¾æ¬¡è¿›å…¥ï¼šManage Jenkinsâ€“Configure Systemï¼Œè¯¥å¤„ä¸»è¦é…ç½®githubæ’ä»¶ã€‚æ‰¾åˆ°GitHub Web Hookï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªmodeï¼Œæˆ‘é€‰çš„â€œ Manually manage hook URLsâ€ï¼Œé€‰å¥½åç‚¹å‡»è¡Œæœ«çš„é—®å·ï¼Œè¯´æ˜ä¸­æœ‰ä¸€ä¸ªurlï¼Œæˆ‘çš„æ˜¯http://173.208.199.58:8080/github-webhook/ï¼Œè®°ä¸‹æ¥ï¼Œåè¾¹æœ‰ç”¨ã€‚åˆ«å¿˜äº†SaveæŒ‰é’®ã€‚</p>
  </li>
  <li>
    <p>è®¾ç½®githubï¼Œæ‰“å¼€githubä¸­çš„é¡¹ç›®ï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯https://github.com/tonghuashuai/OnlyRSSWebï¼Œç„¶åç‚¹å‡»Settingsâ€“Service Hooksï¼Œç„¶åç‚¹å‡»å³ä¾§çš„WebHook URLsï¼Œåœ¨æ‰“å¼€çš„æ–‡æœ¬æ¡†ä¸­å¡«å…¥åˆšæ‰è®°ä¸‹çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯ï¼šhttp://173.208.199.58:8080/github-webhook/ï¼Œç„¶åUpdate settingsã€‚</p>
  </li>
</ul>

<p>è‡³æ­¤å‡†å¤‡å·¥ä½œå®Œæˆã€‚</p>

<p>ä¸‰ã€<strong>å»ºJob</strong></p>

<p>å›åˆ°Jenkinsï¼Œç‚¹å‡» New Jobï¼Œç„¶åå¡«å†™ Job Nameï¼Œä¸‹é¢é€‰é¡¹æ ¹æ®ä¸ªäººæƒ…å†µé€‰æ‹©ï¼Œæˆ‘é€‰çš„ç¬¬ä¸€ä¸ªï¼ŒOKæŒ‰é’®ï¼Œè¿›å…¥è®¾ç½®ç•Œé¢ã€‚æœ‰å‡ ä¸ªåœ°æ–¹éœ€è¦è®¾ç½®</p>

<ul>
  <li>
    <p>Advanced Project Options ä¸‹çš„ Advanced æŒ‰é’®ï¼Œå¦‚æœæƒ³æ”¹å˜å·¥ä½œåŒºå¯ä»¥é€‰æ‹© Use custom workspaceï¼Œç„¶åå¡«å†™æ–°å·¥ä½œç¾¤çš„è·¯å¾„ã€‚å¦‚ï¼š/home/ftp/OnlyRSSWeb</p>
  </li>
  <li>
    <p>Source Code Management ä¸‹é€‰æ‹© Gitï¼ŒRepository URL å¡«å†™é¡¹ç›®åœ°å€ï¼šhttps://github.com/tonghuashuai/OnlyRSSWeb.gitï¼ŒRepository browser é€‰æ‹©githubwebï¼Œurlå¡«å…¥ï¼šhttps://github.com/tonghuashuai/OnlyRSSWeb/ï¼Œæ³¨æ„æ²¡æœ‰.git.</p>
  </li>
  <li>
    <p>Build Triggers ä¸‹é€‰æ‹© Build when a change is pushed to GitHubï¼Œä¹Ÿå°±æ˜¯å½“æœ‰ä»£ç pushåˆ°githubä¸Šæ—¶è§¦å‘buildã€‚</p>
  </li>
  <li>
    <p>Build ä¸‹çš„ Execute shell è¦æ‰§è¡Œçš„è„šæœ¬ã€‚è„šæœ¬æ‰§è¡Œçš„åœ°æ–¹æœ‰å‡ ç‚¹éœ€è¦å•ç‹¬è¯´ï¼Œæ‰€ä»¥æ”¾åˆ°åé¢ã€‚</p>
  </li>
</ul>

<p>è‡³æ­¤ï¼ŒSave å Jobå»ºå®Œã€‚å†™åˆ«é«˜å…´ï¼Œè¿˜æ²¡å®Œã€‚</p>

<p>å››ã€<strong>ç”¨æˆ·</strong></p>

<p>jenkins å®‰è£…å®Œæˆåä¼šå»ºä¸€ä¸ªjenkinsçš„ç”¨æˆ·ï¼Œç”¨æˆ·ç›®å½•åœ¨ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/var/lib/jenkins
</code></pre></div></div>

<p>ä¸å±äºä»»ä½•ç”¨æˆ·ç»„ï¼Œæˆ‘ä»¬å°†å…¶å¯ä»¥åŠ å…¥rootç»„ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gpasswd -a jenkins root
</code></pre></div></div>

<p>äº”ã€<strong>è„šæœ¬é—®é¢˜</strong></p>

<p>æ¥ä¸‹æ¥å°±æ˜¯å¯åŠ¨è„šæœ¬çš„é—®é¢˜äº†ï¼Œç”±äºä»£ç æ›´æ–°åéœ€è¦æ‰§è¡Œä¸€äº›åŠ¨ä½œï¼Œæ¯”å¦‚ï¼šé‡å¯uwsgiã€reload nginxæˆ–è€…æ¸…é™¤pycæ–‡ä»¶ï¼Œé‚£ä¹ˆå°±è¦æŠŠè¿™äº›è„šæœ¬æ”¾åˆ°ç¬¬ä¸‰æ­¥è¯´çš„æ‰§è¡Œè„šæœ¬ä¸­äº†ã€‚æˆ‘çš„åšæ³•æ˜¯æŠŠè„šæœ¬å†™åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­æ¯”å¦‚ï¼šstart.shä¸­ï¼Œç„¶ååœ¨ç¬¬ä¸‰æ­¥çš„æ‰§è¡Œè„šæœ¬ä¸­å¡«å…¥./start.shã€‚ä½†æ˜¯é‡å¯uwsgiï¼Œreload nginxéœ€è¦rootæƒé™çš„ï¼Œå°±ç›®å‰çš„é…ç½®æ‰§è¡Œbuildä¼šæŠ¥ permission denied é”™è¯¯ï¼Œä¹Ÿå°±æ˜¯ jenkins å¯åŠ¨ç”¨æˆ·çš„æƒé™ä¸å¤Ÿï¼Œæ–¹æ³•å°±æ˜¯æˆ‘ä»¬ä¸€rootç”¨æˆ·å¯åŠ¨jenkinsï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo vim /etc/default/jenkins
</code></pre></div></div>

<p>ä¿®æ”¹</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>JENKINS_USER=jenkins
</code></pre></div></div>

<p>ä¸º</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>JENKINS_USER=root
</code></pre></div></div>

<p>é‡å¯jenkinsï¼Œå…¨éƒ¨å®Œæˆã€‚</p>

<p>è‡³äºstart.shè¯¦ç»†å†™æ³•ï¼Œå¯ç§»æ­¥åˆ°æˆ‘çš„githubé¡¹ç›®ï¼š<a href="https://github.com/tonghuashuai/OnlyRSSWeb">https://github.com/tonghuashuai/OnlyRSSWeb</a></p>
:ET